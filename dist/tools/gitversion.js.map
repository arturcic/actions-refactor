<<<<<<< bb28a08c102cb67f136f550f2ef6e41ac0dc52bb
{"version":3,"file":"gitversion.js","sources":["../../src/tools/gitversion/models.ts","../../src/tools/gitversion/settings.ts","../../src/tools/gitversion/tool.ts","../../src/tools/gitversion/runner.ts","../../src/tools/gitversion/main.ts"],"sourcesContent":["export type Commands = 'setup' | 'execute'\r\nexport enum ExecuteFields {\r\n    targetPath = 'targetPath',\r\n    useConfigFile = 'useConfigFile',\r\n    configFilePath = 'configFilePath',\r\n    updateAssemblyInfo = 'updateAssemblyInfo',\r\n    updateAssemblyInfoFilename = 'updateAssemblyInfoFilename',\r\n    additionalArguments = 'additionalArguments',\r\n    srcDir = 'srcDir'\r\n}\r\n\r\nexport interface GitVersionSettings {\r\n    [ExecuteFields.targetPath]: string\r\n    [ExecuteFields.useConfigFile]: boolean\r\n    [ExecuteFields.configFilePath]: string\r\n    [ExecuteFields.updateAssemblyInfo]: boolean\r\n    [ExecuteFields.updateAssemblyInfoFilename]: string\r\n    [ExecuteFields.additionalArguments]: string\r\n    [ExecuteFields.srcDir]: string | undefined\r\n}\r\n\r\nexport interface GitVersionOutput {\r\n    Major: number\r\n    Minor: number\r\n    Patch: number\r\n    PreReleaseTag: string\r\n    PreReleaseTagWithDash: string\r\n    PreReleaseLabel: string\r\n    PreReleaseNumber: number\r\n    WeightedPreReleaseNumber: number\r\n    BuildMetaData: number\r\n    BuildMetaDataPadded: string\r\n    FullBuildMetaData: string\r\n    MajorMinorPatch: string\r\n    SemVer: string\r\n    LegacySemVer: string\r\n    LegacySemVerPadded: string\r\n    AssemblySemVer: string\r\n    AssemblySemFileVer: string\r\n    FullSemVer: string\r\n    InformationalVersion: string\r\n    BranchName: string\r\n    EscapedBranchName: string\r\n    Sha: string\r\n    ShortSha: string\r\n    NuGetVersionV2: string\r\n    NuGetVersion: string\r\n    NuGetPreReleaseTagV2: string\r\n    NuGetPreReleaseTag: string\r\n    VersionSourceSha: string\r\n    CommitsSinceVersionSource: number\r\n    CommitsSinceVersionSourcePadded: string\r\n    UncommittedChanges: number\r\n    CommitDate: string\r\n}\r\n","import { ISettingsProvider, SettingsProvider } from '@tools/common'\r\nimport { ExecuteFields, GitVersionSettings } from './models'\r\n\r\nexport interface IGitVersionSettingsProvider extends ISettingsProvider {\r\n    getGitVersionSettings(): GitVersionSettings\r\n}\r\n\r\nexport class GitVersionSettingsProvider extends SettingsProvider implements IGitVersionSettingsProvider {\r\n    getGitVersionSettings(): GitVersionSettings {\r\n        const targetPath = this.buildAgent.getInput(ExecuteFields.targetPath)\r\n\r\n        const useConfigFile = this.buildAgent.getBooleanInput(ExecuteFields.useConfigFile)\r\n        const configFilePath = this.buildAgent.getInput(ExecuteFields.configFilePath)\r\n\r\n        const updateAssemblyInfo = this.buildAgent.getBooleanInput(ExecuteFields.updateAssemblyInfo)\r\n        const updateAssemblyInfoFilename = this.buildAgent.getInput(ExecuteFields.updateAssemblyInfoFilename)\r\n\r\n        const additionalArguments = this.buildAgent.getInput(ExecuteFields.additionalArguments)\r\n\r\n        const srcDir = this.buildAgent.sourceDir?.replace(/\\\\/g, '/')\r\n\r\n        return {\r\n            targetPath,\r\n            useConfigFile,\r\n            configFilePath,\r\n            updateAssemblyInfo,\r\n            updateAssemblyInfoFilename,\r\n            additionalArguments,\r\n            srcDir\r\n        }\r\n    }\r\n}\r\n","import { IExecResult } from '@agents/common'\r\nimport { DotnetTool } from '@tools/common'\r\nimport { GitVersionSettingsProvider, IGitVersionSettingsProvider } from './settings'\r\nimport { GitVersionOutput, GitVersionSettings } from './models'\r\nimport * as path from 'path'\r\nimport * as os from 'os'\r\n\r\nexport class GitVersionTool extends DotnetTool {\r\n    get toolName(): string {\r\n        return 'GitVersion.Tool'\r\n    }\r\n\r\n    get settingsProvider(): IGitVersionSettingsProvider {\r\n        return new GitVersionSettingsProvider(this.buildAgent)\r\n    }\r\n\r\n    async run(): Promise<IExecResult> {\r\n        const settings = this.settingsProvider.getGitVersionSettings()\r\n        const workDir = await this.getRepoDir(settings.targetPath)\r\n        const args = await this.getArguments(workDir, settings)\r\n\r\n        await this.setDotnetRoot()\r\n\r\n        let toolPath: string | undefined\r\n        const gitVersionPath = this.buildAgent.getVariableAsPath('GITVERSION_PATH')\r\n        if (gitVersionPath) {\r\n            toolPath = path.join(gitVersionPath, os.platform() === 'win32' ? 'dotnet-gitversion.exe' : 'dotnet-gitversion')\r\n        }\r\n        if (!toolPath) {\r\n            toolPath = await this.buildAgent.which('dotnet-gitversion', true)\r\n        }\r\n        return this.execute(toolPath, args)\r\n    }\r\n\r\n    writeGitVersionToAgent(output: GitVersionOutput): void {\r\n        const keysFn = Object.keys as <T extends object>(obj: T) => (keyof T)[]\r\n        const keys = keysFn<GitVersionOutput>(output)\r\n        for (const property of keys) {\r\n            const name = this.toCamelCase(property)\r\n            try {\r\n                const value = output[property]?.toString()\r\n                this.buildAgent.setOutput(name, value)\r\n                this.buildAgent.setOutput(`GitVersion_${property}`, value)\r\n                this.buildAgent.setVariable(name, value)\r\n                this.buildAgent.setVariable(`GitVersion_${property}`, value)\r\n            } catch (error) {\r\n                this.buildAgent.error(`Unable to set output/variable for ${property}`)\r\n            }\r\n        }\r\n    }\r\n\r\n    protected async getRepoDir(targetPath: string): Promise<string> {\r\n        let workDir: string\r\n        if (!targetPath) {\r\n            workDir = this.buildAgent.sourceDir || '.'\r\n        } else {\r\n            if (await this.buildAgent.dirExists(targetPath)) {\r\n                workDir = targetPath\r\n            } else {\r\n                throw new Error(`Directory not found at ${targetPath}`)\r\n            }\r\n        }\r\n        return workDir.replace(/\\\\/g, '/')\r\n    }\r\n\r\n    protected async getArguments(workDir: string, options: GitVersionSettings): Promise<string[]> {\r\n        let args = [workDir, '/output', 'json', '/output', 'buildserver']\r\n\r\n        const { useConfigFile, configFilePath, updateAssemblyInfo, updateAssemblyInfoFilename, additionalArguments } = options\r\n\r\n        if (useConfigFile) {\r\n            if (await this.isValidInputFile('configFilePath', configFilePath)) {\r\n                args.push('/config', configFilePath)\r\n            } else {\r\n                throw new Error(`GitVersion configuration file not found at ${configFilePath}`)\r\n            }\r\n        }\r\n        if (updateAssemblyInfo) {\r\n            args.push('/updateassemblyinfo')\r\n\r\n            // You can specify 'updateAssemblyInfo' without 'updateAssemblyInfoFilename'.\r\n            if (updateAssemblyInfoFilename?.length > 0) {\r\n                if (await this.isValidInputFile('updateAssemblyInfoFilename', updateAssemblyInfoFilename)) {\r\n                    args.push(updateAssemblyInfoFilename)\r\n                } else {\r\n                    throw new Error(`AssemblyInfoFilename file not found at ${updateAssemblyInfoFilename}`)\r\n                }\r\n            }\r\n        }\r\n\r\n        if (additionalArguments) {\r\n            args = args.concat(this.argStringToArray(additionalArguments))\r\n        }\r\n        return args\r\n    }\r\n\r\n    private argStringToArray(argString: string): string[] {\r\n        const args: string[] = []\r\n\r\n        let inQuotes = false\r\n        let escaped = false\r\n        let lastCharWasSpace = true\r\n        let arg = ''\r\n\r\n        const append = (c: string): void => {\r\n            // we only escape double quotes.\r\n            if (escaped && c !== '\"') {\r\n                arg += '\\\\'\r\n            }\r\n\r\n            arg += c\r\n            escaped = false\r\n        }\r\n\r\n        for (let i = 0; i < argString.length; i++) {\r\n            const c = argString.charAt(i)\r\n\r\n            if (c === ' ' && !inQuotes) {\r\n                if (!lastCharWasSpace) {\r\n                    args.push(arg)\r\n                    arg = ''\r\n                }\r\n                lastCharWasSpace = true\r\n                continue\r\n            } else {\r\n                lastCharWasSpace = false\r\n            }\r\n\r\n            if (c === '\"') {\r\n                if (!escaped) {\r\n                    inQuotes = !inQuotes\r\n                } else {\r\n                    append(c)\r\n                }\r\n                continue\r\n            }\r\n\r\n            if (c === '\\\\' && escaped) {\r\n                append(c)\r\n                continue\r\n            }\r\n\r\n            if (c === '\\\\' && inQuotes) {\r\n                escaped = true\r\n                continue\r\n            }\r\n\r\n            append(c)\r\n            lastCharWasSpace = false\r\n        }\r\n\r\n        if (!lastCharWasSpace) {\r\n            args.push(arg.trim())\r\n        }\r\n\r\n        return args\r\n    }\r\n\r\n    private toCamelCase(input: string): string {\r\n        return input.replace(/^\\w|[A-Z]|\\b\\w|\\s+/g, function (match, index) {\r\n            if (+match === 0) return '' // or if (/\\s+/.test(match)) for white spaces\r\n            return index === 0 ? match.toLowerCase() : match.toUpperCase()\r\n        })\r\n    }\r\n}\r\n","import { IBuildAgent } from '@agents/common'\r\nimport { GitVersionTool } from './tool'\r\nimport { Commands } from './models'\r\n\r\nexport class Runner {\r\n    private readonly gitVersionTool: GitVersionTool\r\n\r\n    constructor(private readonly agent: IBuildAgent) {\r\n        this.gitVersionTool = new GitVersionTool(this.agent)\r\n    }\r\n\r\n    async run(command: Commands): Promise<number> {\r\n        switch (command) {\r\n            case 'setup':\r\n                return await this.setup()\r\n            case 'execute':\r\n                return await this.execute()\r\n        }\r\n    }\r\n\r\n    private async setup(): Promise<number> {\r\n        try {\r\n            this.agent.info(`Running on: '${this.agent.agentName}'`)\r\n            this.agent.debug('Disabling telemetry')\r\n            this.gitVersionTool.disableTelemetry()\r\n\r\n            this.agent.debug('Installing GitVersion')\r\n            const toolPath = await this.gitVersionTool.install()\r\n\r\n            this.agent.info(`Set GITVERSION_PATH to ${toolPath}`)\r\n            this.agent.setVariable('GITVERSION_PATH', toolPath)\r\n            return 0\r\n        } catch (error) {\r\n            console.log(error)\r\n            if (error instanceof Error) {\r\n                this.agent.setFailed(error?.message, true)\r\n            }\r\n            return -1\r\n        }\r\n    }\r\n\r\n    private async execute(): Promise<number> {\r\n        try {\r\n            this.agent.debug(`Agent: '${this.agent.agentName}'`)\r\n            this.agent.debug('Disabling telemetry')\r\n            this.gitVersionTool.disableTelemetry()\r\n\r\n            this.agent.debug('Executing GitVersion')\r\n            const result = await this.gitVersionTool.run()\r\n\r\n            if (result.code === 0) {\r\n                this.agent.debug('GitVersion executed successfully')\r\n                const { stdout } = result\r\n\r\n                if (stdout.lastIndexOf('{') === -1 || stdout.lastIndexOf('}') === -1) {\r\n                    this.agent.debug('GitVersion output is not valid JSON')\r\n                    this.agent.setFailed('GitVersion output is not valid JSON', true)\r\n                    return -1\r\n                } else {\r\n                    const jsonOutput = stdout.substring(stdout.lastIndexOf('{'), stdout.lastIndexOf('}') + 1)\r\n\r\n                    const gitVersionOutput = JSON.parse(jsonOutput)\r\n                    this.gitVersionTool.writeGitVersionToAgent(gitVersionOutput)\r\n                    this.agent.setSucceeded('GitVersion executed successfully', true)\r\n                    return 0\r\n                }\r\n            } else {\r\n                this.agent.debug('GitVersion failed')\r\n                const error = result.error\r\n                if (error instanceof Error) {\r\n                    this.agent.setFailed(error?.message, true)\r\n                }\r\n                return -1\r\n            }\r\n        } catch (error) {\r\n            if (error instanceof Error) {\r\n                this.agent.setFailed(error?.message, true)\r\n            }\r\n            return -1\r\n        }\r\n    }\r\n}\r\n","import { getAgent } from '@agents/common'\r\nimport { parseCliArgs } from '@tools/common'\r\nimport { type Commands, Runner } from '@tools/gitversion'\r\n\r\nconst { command, buildAgent } = parseCliArgs()\r\nconst agent = await getAgent(buildAgent)\r\nconst runner = new Runner(agent)\r\nawait runner.run(command as Commands)\r\n"],"names":["ExecuteFields"],"mappings":"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"}
=======
{"version":3,"file":"gitversion.js","sources":["../../src/tools/gitversion/models.ts","../../src/tools/gitversion/settings.ts","../../src/tools/gitversion/tool.ts","../../src/tools/gitversion/runner.ts","../../src/tools/gitversion/main.ts"],"sourcesContent":["export type Commands = 'setup' | 'execute'\nexport enum ExecuteFields {\n    targetPath = 'targetPath',\n    useConfigFile = 'useConfigFile',\n    configFilePath = 'configFilePath',\n    updateAssemblyInfo = 'updateAssemblyInfo',\n    updateAssemblyInfoFilename = 'updateAssemblyInfoFilename',\n    additionalArguments = 'additionalArguments',\n    srcDir = 'srcDir'\n}\n\nexport interface GitVersionSettings {\n    [ExecuteFields.targetPath]: string\n    [ExecuteFields.useConfigFile]: boolean\n    [ExecuteFields.configFilePath]: string\n    [ExecuteFields.updateAssemblyInfo]: boolean\n    [ExecuteFields.updateAssemblyInfoFilename]: string\n    [ExecuteFields.additionalArguments]: string\n    [ExecuteFields.srcDir]: string | undefined\n}\n\nexport interface GitVersionOutput {\n    Major: number\n    Minor: number\n    Patch: number\n    PreReleaseTag: string\n    PreReleaseTagWithDash: string\n    PreReleaseLabel: string\n    PreReleaseNumber: number\n    WeightedPreReleaseNumber: number\n    BuildMetaData: number\n    BuildMetaDataPadded: string\n    FullBuildMetaData: string\n    MajorMinorPatch: string\n    SemVer: string\n    LegacySemVer: string\n    LegacySemVerPadded: string\n    AssemblySemVer: string\n    AssemblySemFileVer: string\n    FullSemVer: string\n    InformationalVersion: string\n    BranchName: string\n    EscapedBranchName: string\n    Sha: string\n    ShortSha: string\n    NuGetVersionV2: string\n    NuGetVersion: string\n    NuGetPreReleaseTagV2: string\n    NuGetPreReleaseTag: string\n    VersionSourceSha: string\n    CommitsSinceVersionSource: number\n    CommitsSinceVersionSourcePadded: string\n    UncommittedChanges: number\n    CommitDate: string\n}\n","import { ISettingsProvider, SettingsProvider } from '@tools/common'\nimport { ExecuteFields, GitVersionSettings } from './models'\n\nexport interface IGitVersionSettingsProvider extends ISettingsProvider {\n    getGitVersionSettings(): GitVersionSettings\n}\n\nexport class GitVersionSettingsProvider extends SettingsProvider implements IGitVersionSettingsProvider {\n    getGitVersionSettings(): GitVersionSettings {\n        const targetPath = this.buildAgent.getInput(ExecuteFields.targetPath)\n\n        const useConfigFile = this.buildAgent.getBooleanInput(ExecuteFields.useConfigFile)\n        const configFilePath = this.buildAgent.getInput(ExecuteFields.configFilePath)\n\n        const updateAssemblyInfo = this.buildAgent.getBooleanInput(ExecuteFields.updateAssemblyInfo)\n        const updateAssemblyInfoFilename = this.buildAgent.getInput(ExecuteFields.updateAssemblyInfoFilename)\n\n        const additionalArguments = this.buildAgent.getInput(ExecuteFields.additionalArguments)\n\n        const srcDir = this.buildAgent.sourceDir?.replace(/\\\\/g, '/')\n\n        return {\n            targetPath,\n            useConfigFile,\n            configFilePath,\n            updateAssemblyInfo,\n            updateAssemblyInfoFilename,\n            additionalArguments,\n            srcDir\n        }\n    }\n}\n","import * as os from 'os'\nimport * as path from 'path'\nimport { IExecResult } from '@agents/common'\nimport { DotnetTool } from '@tools/common'\nimport { GitVersionOutput, GitVersionSettings } from './models'\nimport { GitVersionSettingsProvider, IGitVersionSettingsProvider } from './settings'\n\nexport class GitVersionTool extends DotnetTool {\n    get toolName(): string {\n        return 'GitVersion.Tool'\n    }\n\n    get settingsProvider(): IGitVersionSettingsProvider {\n        return new GitVersionSettingsProvider(this.buildAgent)\n    }\n\n    async run(): Promise<IExecResult> {\n        const settings = this.settingsProvider.getGitVersionSettings()\n        const workDir = await this.getRepoDir(settings.targetPath)\n        const args = await this.getArguments(workDir, settings)\n\n        await this.setDotnetRoot()\n\n        let toolPath: string | undefined\n        const gitVersionPath = this.buildAgent.getVariableAsPath('GITVERSION_PATH')\n        if (gitVersionPath) {\n            toolPath = path.join(gitVersionPath, os.platform() === 'win32' ? 'dotnet-gitversion.exe' : 'dotnet-gitversion')\n        }\n        if (!toolPath) {\n            toolPath = await this.buildAgent.which('dotnet-gitversion', true)\n        }\n        return this.execute(toolPath, args)\n    }\n\n    writeGitVersionToAgent(output: GitVersionOutput): void {\n        const keysFn = Object.keys as <T extends object>(obj: T) => (keyof T)[]\n        const keys = keysFn<GitVersionOutput>(output)\n        for (const property of keys) {\n            const name = this.toCamelCase(property)\n            try {\n                const value = output[property]?.toString()\n                this.buildAgent.setOutput(name, value)\n                this.buildAgent.setOutput(`GitVersion_${property}`, value)\n                this.buildAgent.setVariable(name, value)\n                this.buildAgent.setVariable(`GitVersion_${property}`, value)\n            } catch (error) {\n                this.buildAgent.error(`Unable to set output/variable for ${property}`)\n            }\n        }\n    }\n\n    protected async getRepoDir(targetPath: string): Promise<string> {\n        let workDir: string\n        if (!targetPath) {\n            workDir = this.buildAgent.sourceDir || '.'\n        } else {\n            if (await this.buildAgent.dirExists(targetPath)) {\n                workDir = targetPath\n            } else {\n                throw new Error(`Directory not found at ${targetPath}`)\n            }\n        }\n        return workDir.replace(/\\\\/g, '/')\n    }\n\n    protected async getArguments(workDir: string, options: GitVersionSettings): Promise<string[]> {\n        let args = [workDir, '/output', 'json', '/output', 'buildserver']\n\n        const { useConfigFile, configFilePath, updateAssemblyInfo, updateAssemblyInfoFilename, additionalArguments } = options\n\n        if (useConfigFile) {\n            if (await this.isValidInputFile('configFilePath', configFilePath)) {\n                args.push('/config', configFilePath)\n            } else {\n                throw new Error(`GitVersion configuration file not found at ${configFilePath}`)\n            }\n        }\n        if (updateAssemblyInfo) {\n            args.push('/updateassemblyinfo')\n\n            // You can specify 'updateAssemblyInfo' without 'updateAssemblyInfoFilename'.\n            if (updateAssemblyInfoFilename?.length > 0) {\n                if (await this.isValidInputFile('updateAssemblyInfoFilename', updateAssemblyInfoFilename)) {\n                    args.push(updateAssemblyInfoFilename)\n                } else {\n                    throw new Error(`AssemblyInfoFilename file not found at ${updateAssemblyInfoFilename}`)\n                }\n            }\n        }\n\n        if (additionalArguments) {\n            args = args.concat(this.argStringToArray(additionalArguments))\n        }\n        return args\n    }\n\n    private argStringToArray(argString: string): string[] {\n        const args: string[] = []\n\n        let inQuotes = false\n        let escaped = false\n        let lastCharWasSpace = true\n        let arg = ''\n\n        const append = (c: string): void => {\n            // we only escape double quotes.\n            if (escaped && c !== '\"') {\n                arg += '\\\\'\n            }\n\n            arg += c\n            escaped = false\n        }\n\n        for (let i = 0; i < argString.length; i++) {\n            const c = argString.charAt(i)\n\n            if (c === ' ' && !inQuotes) {\n                if (!lastCharWasSpace) {\n                    args.push(arg)\n                    arg = ''\n                }\n                lastCharWasSpace = true\n                continue\n            } else {\n                lastCharWasSpace = false\n            }\n\n            if (c === '\"') {\n                if (!escaped) {\n                    inQuotes = !inQuotes\n                } else {\n                    append(c)\n                }\n                continue\n            }\n\n            if (c === '\\\\' && escaped) {\n                append(c)\n                continue\n            }\n\n            if (c === '\\\\' && inQuotes) {\n                escaped = true\n                continue\n            }\n\n            append(c)\n            lastCharWasSpace = false\n        }\n\n        if (!lastCharWasSpace) {\n            args.push(arg.trim())\n        }\n\n        return args\n    }\n\n    private toCamelCase(input: string): string {\n        return input.replace(/^\\w|[A-Z]|\\b\\w|\\s+/g, function (match, index) {\n            if (+match === 0) return '' // or if (/\\s+/.test(match)) for white spaces\n            return index === 0 ? match.toLowerCase() : match.toUpperCase()\n        })\n    }\n}\n","import { IBuildAgent } from '@agents/common'\nimport { Commands } from './models'\nimport { GitVersionTool } from './tool'\n\nexport class Runner {\n    private readonly gitVersionTool: GitVersionTool\n\n    constructor(private readonly agent: IBuildAgent) {\n        this.gitVersionTool = new GitVersionTool(this.agent)\n    }\n\n    async run(command: Commands): Promise<number> {\n        switch (command) {\n            case 'setup':\n                return await this.setup()\n            case 'execute':\n                return await this.execute()\n        }\n    }\n\n    private async setup(): Promise<number> {\n        try {\n            this.agent.info(`Running on: '${this.agent.agentName}'`)\n            this.agent.debug('Disabling telemetry')\n            this.gitVersionTool.disableTelemetry()\n\n            this.agent.debug('Installing GitVersion')\n            const toolPath = await this.gitVersionTool.install()\n\n            this.agent.info(`Set GITVERSION_PATH to ${toolPath}`)\n            this.agent.setVariable('GITVERSION_PATH', toolPath)\n            return 0\n        } catch (error) {\n            console.log(error)\n            if (error instanceof Error) {\n                this.agent.setFailed(error?.message, true)\n            }\n            return -1\n        }\n    }\n\n    private async execute(): Promise<number> {\n        try {\n            this.agent.debug(`Agent: '${this.agent.agentName}'`)\n            this.agent.debug('Disabling telemetry')\n            this.gitVersionTool.disableTelemetry()\n\n            this.agent.info('Executing GitVersion')\n            const result = await this.gitVersionTool.run()\n\n            if (result.code === 0) {\n                this.agent.info('GitVersion executed successfully')\n                const { stdout } = result\n\n                this.agent.info('GitVersion output:')\n                this.agent.info('-------------------')\n                this.agent.info(stdout)\n                this.agent.info('-------------------')\n\n                this.agent.debug('Parsing GitVersion output')\n                if (stdout.lastIndexOf('{') === -1 || stdout.lastIndexOf('}') === -1) {\n                    this.agent.debug('GitVersion output is not valid JSON')\n                    this.agent.setFailed('GitVersion output is not valid JSON', true)\n                    return -1\n                } else {\n                    const jsonOutput = stdout.substring(stdout.lastIndexOf('{'), stdout.lastIndexOf('}') + 1)\n\n                    const gitVersionOutput = JSON.parse(jsonOutput)\n                    this.gitVersionTool.writeGitVersionToAgent(gitVersionOutput)\n                    this.agent.setSucceeded('GitVersion executed successfully', true)\n                    return 0\n                }\n            } else {\n                this.agent.debug('GitVersion failed')\n                const error = result.error\n                if (error instanceof Error) {\n                    this.agent.setFailed(error?.message, true)\n                }\n                return -1\n            }\n        } catch (error) {\n            if (error instanceof Error) {\n                this.agent.setFailed(error?.message, true)\n            }\n            return -1\n        }\n    }\n}\n","import { getAgent } from '@agents/common'\nimport { parseCliArgs } from '@tools/common'\nimport { type Commands, Runner } from '@tools/gitversion'\n\nconst { command, buildAgent } = parseCliArgs()\nconst agent = await getAgent(buildAgent)\nconst runner = new Runner(agent)\nawait runner.run(command as Commands)\n"],"names":["ExecuteFields"],"mappings":"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"}
>>>>>>> include GitVersion output in the pipeline output
